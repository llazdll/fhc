{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a7f2ce84",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:08.204872Z",
     "iopub.status.busy": "2025-12-20T08:56:08.203869Z",
     "iopub.status.idle": "2025-12-20T08:56:09.323105Z",
     "shell.execute_reply": "2025-12-20T08:56:09.321747Z"
    },
    "papermill": {
     "duration": 1.128726,
     "end_time": "2025-12-20T08:56:09.325865",
     "exception": false,
     "start_time": "2025-12-20T08:56:08.197139",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/fetal-health-classification/fetal_health.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9cf08e84",
   "metadata": {
    "papermill": {
     "duration": 0.003734,
     "end_time": "2025-12-20T08:56:09.333623",
     "exception": false,
     "start_time": "2025-12-20T08:56:09.329889",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## üöÄ **Imports**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "6c7cfba1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:09.343639Z",
     "iopub.status.busy": "2025-12-20T08:56:09.342647Z",
     "iopub.status.idle": "2025-12-20T08:56:16.650439Z",
     "shell.execute_reply": "2025-12-20T08:56:16.648899Z"
    },
    "papermill": {
     "duration": 7.31619,
     "end_time": "2025-12-20T08:56:16.653478",
     "exception": false,
     "start_time": "2025-12-20T08:56:09.337288",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import pandas as pd\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "import torch\n",
    "from torch.utils.data import TensorDataset, DataLoader\n",
    "import torch.nn as nn\n",
    "from torch.optim import SGD"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b3446e77",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.663780Z",
     "iopub.status.busy": "2025-12-20T08:56:16.663214Z",
     "iopub.status.idle": "2025-12-20T08:56:16.769835Z",
     "shell.execute_reply": "2025-12-20T08:56:16.768573Z"
    },
    "papermill": {
     "duration": 0.114555,
     "end_time": "2025-12-20T08:56:16.772191",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.657636",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>baseline value</th>\n",
       "      <th>accelerations</th>\n",
       "      <th>fetal_movement</th>\n",
       "      <th>uterine_contractions</th>\n",
       "      <th>light_decelerations</th>\n",
       "      <th>severe_decelerations</th>\n",
       "      <th>prolongued_decelerations</th>\n",
       "      <th>abnormal_short_term_variability</th>\n",
       "      <th>mean_value_of_short_term_variability</th>\n",
       "      <th>percentage_of_time_with_abnormal_long_term_variability</th>\n",
       "      <th>...</th>\n",
       "      <th>histogram_min</th>\n",
       "      <th>histogram_max</th>\n",
       "      <th>histogram_number_of_peaks</th>\n",
       "      <th>histogram_number_of_zeroes</th>\n",
       "      <th>histogram_mode</th>\n",
       "      <th>histogram_mean</th>\n",
       "      <th>histogram_median</th>\n",
       "      <th>histogram_variance</th>\n",
       "      <th>histogram_tendency</th>\n",
       "      <th>fetal_health</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.00000</td>\n",
       "      <td>...</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "      <td>2126.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>133.303857</td>\n",
       "      <td>0.003178</td>\n",
       "      <td>0.009481</td>\n",
       "      <td>0.004366</td>\n",
       "      <td>0.001889</td>\n",
       "      <td>0.000003</td>\n",
       "      <td>0.000159</td>\n",
       "      <td>46.990122</td>\n",
       "      <td>1.332785</td>\n",
       "      <td>9.84666</td>\n",
       "      <td>...</td>\n",
       "      <td>93.579492</td>\n",
       "      <td>164.025400</td>\n",
       "      <td>4.068203</td>\n",
       "      <td>0.323612</td>\n",
       "      <td>137.452023</td>\n",
       "      <td>134.610536</td>\n",
       "      <td>138.090310</td>\n",
       "      <td>18.808090</td>\n",
       "      <td>0.320320</td>\n",
       "      <td>1.304327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>9.840844</td>\n",
       "      <td>0.003866</td>\n",
       "      <td>0.046666</td>\n",
       "      <td>0.002946</td>\n",
       "      <td>0.002960</td>\n",
       "      <td>0.000057</td>\n",
       "      <td>0.000590</td>\n",
       "      <td>17.192814</td>\n",
       "      <td>0.883241</td>\n",
       "      <td>18.39688</td>\n",
       "      <td>...</td>\n",
       "      <td>29.560212</td>\n",
       "      <td>17.944183</td>\n",
       "      <td>2.949386</td>\n",
       "      <td>0.706059</td>\n",
       "      <td>16.381289</td>\n",
       "      <td>15.593596</td>\n",
       "      <td>14.466589</td>\n",
       "      <td>28.977636</td>\n",
       "      <td>0.610829</td>\n",
       "      <td>0.614377</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>106.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>...</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>122.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>60.000000</td>\n",
       "      <td>73.000000</td>\n",
       "      <td>77.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>126.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.002000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>32.000000</td>\n",
       "      <td>0.700000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>...</td>\n",
       "      <td>67.000000</td>\n",
       "      <td>152.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>129.000000</td>\n",
       "      <td>125.000000</td>\n",
       "      <td>129.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>133.000000</td>\n",
       "      <td>0.002000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.004000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>49.000000</td>\n",
       "      <td>1.200000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>...</td>\n",
       "      <td>93.000000</td>\n",
       "      <td>162.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>139.000000</td>\n",
       "      <td>136.000000</td>\n",
       "      <td>139.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>140.000000</td>\n",
       "      <td>0.006000</td>\n",
       "      <td>0.003000</td>\n",
       "      <td>0.007000</td>\n",
       "      <td>0.003000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>61.000000</td>\n",
       "      <td>1.700000</td>\n",
       "      <td>11.00000</td>\n",
       "      <td>...</td>\n",
       "      <td>120.000000</td>\n",
       "      <td>174.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>148.000000</td>\n",
       "      <td>145.000000</td>\n",
       "      <td>148.000000</td>\n",
       "      <td>24.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>160.000000</td>\n",
       "      <td>0.019000</td>\n",
       "      <td>0.481000</td>\n",
       "      <td>0.015000</td>\n",
       "      <td>0.015000</td>\n",
       "      <td>0.001000</td>\n",
       "      <td>0.005000</td>\n",
       "      <td>87.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>91.00000</td>\n",
       "      <td>...</td>\n",
       "      <td>159.000000</td>\n",
       "      <td>238.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>187.000000</td>\n",
       "      <td>182.000000</td>\n",
       "      <td>186.000000</td>\n",
       "      <td>269.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8 rows √ó 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       baseline value  accelerations  fetal_movement  uterine_contractions  \\\n",
       "count     2126.000000    2126.000000     2126.000000           2126.000000   \n",
       "mean       133.303857       0.003178        0.009481              0.004366   \n",
       "std          9.840844       0.003866        0.046666              0.002946   \n",
       "min        106.000000       0.000000        0.000000              0.000000   \n",
       "25%        126.000000       0.000000        0.000000              0.002000   \n",
       "50%        133.000000       0.002000        0.000000              0.004000   \n",
       "75%        140.000000       0.006000        0.003000              0.007000   \n",
       "max        160.000000       0.019000        0.481000              0.015000   \n",
       "\n",
       "       light_decelerations  severe_decelerations  prolongued_decelerations  \\\n",
       "count          2126.000000           2126.000000               2126.000000   \n",
       "mean              0.001889              0.000003                  0.000159   \n",
       "std               0.002960              0.000057                  0.000590   \n",
       "min               0.000000              0.000000                  0.000000   \n",
       "25%               0.000000              0.000000                  0.000000   \n",
       "50%               0.000000              0.000000                  0.000000   \n",
       "75%               0.003000              0.000000                  0.000000   \n",
       "max               0.015000              0.001000                  0.005000   \n",
       "\n",
       "       abnormal_short_term_variability  mean_value_of_short_term_variability  \\\n",
       "count                      2126.000000                           2126.000000   \n",
       "mean                         46.990122                              1.332785   \n",
       "std                          17.192814                              0.883241   \n",
       "min                          12.000000                              0.200000   \n",
       "25%                          32.000000                              0.700000   \n",
       "50%                          49.000000                              1.200000   \n",
       "75%                          61.000000                              1.700000   \n",
       "max                          87.000000                              7.000000   \n",
       "\n",
       "       percentage_of_time_with_abnormal_long_term_variability  ...  \\\n",
       "count                                         2126.00000       ...   \n",
       "mean                                             9.84666       ...   \n",
       "std                                             18.39688       ...   \n",
       "min                                              0.00000       ...   \n",
       "25%                                              0.00000       ...   \n",
       "50%                                              0.00000       ...   \n",
       "75%                                             11.00000       ...   \n",
       "max                                             91.00000       ...   \n",
       "\n",
       "       histogram_min  histogram_max  histogram_number_of_peaks  \\\n",
       "count    2126.000000    2126.000000                2126.000000   \n",
       "mean       93.579492     164.025400                   4.068203   \n",
       "std        29.560212      17.944183                   2.949386   \n",
       "min        50.000000     122.000000                   0.000000   \n",
       "25%        67.000000     152.000000                   2.000000   \n",
       "50%        93.000000     162.000000                   3.000000   \n",
       "75%       120.000000     174.000000                   6.000000   \n",
       "max       159.000000     238.000000                  18.000000   \n",
       "\n",
       "       histogram_number_of_zeroes  histogram_mode  histogram_mean  \\\n",
       "count                 2126.000000     2126.000000     2126.000000   \n",
       "mean                     0.323612      137.452023      134.610536   \n",
       "std                      0.706059       16.381289       15.593596   \n",
       "min                      0.000000       60.000000       73.000000   \n",
       "25%                      0.000000      129.000000      125.000000   \n",
       "50%                      0.000000      139.000000      136.000000   \n",
       "75%                      0.000000      148.000000      145.000000   \n",
       "max                     10.000000      187.000000      182.000000   \n",
       "\n",
       "       histogram_median  histogram_variance  histogram_tendency  fetal_health  \n",
       "count       2126.000000         2126.000000         2126.000000   2126.000000  \n",
       "mean         138.090310           18.808090            0.320320      1.304327  \n",
       "std           14.466589           28.977636            0.610829      0.614377  \n",
       "min           77.000000            0.000000           -1.000000      1.000000  \n",
       "25%          129.000000            2.000000            0.000000      1.000000  \n",
       "50%          139.000000            7.000000            0.000000      1.000000  \n",
       "75%          148.000000           24.000000            1.000000      1.000000  \n",
       "max          186.000000          269.000000            1.000000      3.000000  \n",
       "\n",
       "[8 rows x 22 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fhc=pd.read_csv('/kaggle/input/fetal-health-classification/fetal_health.csv')\n",
    "fhc.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f341cf91",
   "metadata": {
    "papermill": {
     "duration": 0.004758,
     "end_time": "2025-12-20T08:56:16.781271",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.776513",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#  üìä Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6e2db0c1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.792153Z",
     "iopub.status.busy": "2025-12-20T08:56:16.791763Z",
     "iopub.status.idle": "2025-12-20T08:56:16.807537Z",
     "shell.execute_reply": "2025-12-20T08:56:16.806210Z"
    },
    "papermill": {
     "duration": 0.024079,
     "end_time": "2025-12-20T08:56:16.809942",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.785863",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((2126, 21), (2126, 1))"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X = fhc.drop([\"fetal_health\"], axis=1).values\n",
    "y = fhc['fetal_health'].values.reshape(-1,1)\n",
    "X.shape, y.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "bf96d029",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.820706Z",
     "iopub.status.busy": "2025-12-20T08:56:16.820379Z",
     "iopub.status.idle": "2025-12-20T08:56:16.827694Z",
     "shell.execute_reply": "2025-12-20T08:56:16.826448Z"
    },
    "papermill": {
     "duration": 0.015866,
     "end_time": "2025-12-20T08:56:16.830273",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.814407",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.],\n",
       "       [0.],\n",
       "       [0.],\n",
       "       [0.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [2.],\n",
       "       [1.],\n",
       "       [1.],\n",
       "       [0.],\n",
       "       [0.],\n",
       "       [0.],\n",
       "       [0.],\n",
       "       [0.],\n",
       "       [1.],\n",
       "       [0.],\n",
       "       [0.]])"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#y decode to 012\n",
    "y=y-1\n",
    "y[1:20]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f1a02bb0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.841392Z",
     "iopub.status.busy": "2025-12-20T08:56:16.841016Z",
     "iopub.status.idle": "2025-12-20T08:56:16.848104Z",
     "shell.execute_reply": "2025-12-20T08:56:16.847005Z"
    },
    "papermill": {
     "duration": 0.015556,
     "end_time": "2025-12-20T08:56:16.850422",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.834866",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2126 21 3\n"
     ]
    }
   ],
   "source": [
    "num_samples, num_features = fhc.shape\n",
    "num_features -= 1\n",
    "num_classes = len(np.unique(y))\n",
    "print(num_samples, num_features,num_classes)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ae804cda",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.862116Z",
     "iopub.status.busy": "2025-12-20T08:56:16.861211Z",
     "iopub.status.idle": "2025-12-20T08:56:16.895035Z",
     "shell.execute_reply": "2025-12-20T08:56:16.893956Z"
    },
    "papermill": {
     "duration": 0.042464,
     "end_time": "2025-12-20T08:56:16.897586",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.855122",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((1530, 21), (1530, 1), (170, 21), (170, 1), (426, 21), (426, 1))"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, random_state=10, stratify=y)\n",
    "X_train, X_valid, y_train, y_valid = train_test_split(X_train, y_train, train_size=0.9, random_state=10, stratify=y_train)\n",
    "X_train.shape, y_train.shape, X_valid.shape, y_valid.shape, X_test.shape, y_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "132674c9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.908997Z",
     "iopub.status.busy": "2025-12-20T08:56:16.908644Z",
     "iopub.status.idle": "2025-12-20T08:56:16.916593Z",
     "shell.execute_reply": "2025-12-20T08:56:16.915605Z"
    },
    "papermill": {
     "duration": 0.016682,
     "end_time": "2025-12-20T08:56:16.919103",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.902421",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "x_scaler = StandardScaler()\n",
    "X_train = x_scaler.fit_transform(X_train)\n",
    "X_valid = x_scaler.transform(X_valid)\n",
    "X_test = x_scaler.transform(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "852fd2de",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.930499Z",
     "iopub.status.busy": "2025-12-20T08:56:16.930074Z",
     "iopub.status.idle": "2025-12-20T08:56:16.975345Z",
     "shell.execute_reply": "2025-12-20T08:56:16.974245Z"
    },
    "papermill": {
     "duration": 0.053976,
     "end_time": "2025-12-20T08:56:16.977799",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.923823",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(torch.Size([1530, 21]),\n",
       " torch.Size([1530, 1]),\n",
       " torch.Size([170, 21]),\n",
       " torch.Size([170, 1]),\n",
       " torch.Size([426, 21]),\n",
       " torch.Size([426, 1]))"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train = torch.tensor(X_train, dtype=torch.float32)\n",
    "y_train = torch.tensor(y_train, dtype=torch.float32)\n",
    "\n",
    "X_valid = torch.tensor(X_valid, dtype=torch.float32)\n",
    "y_valid = torch.tensor(y_valid, dtype=torch.float32)\n",
    "\n",
    "X_test = torch.tensor(X_test, dtype=torch.float32)\n",
    "y_test = torch.tensor(y_test, dtype=torch.float32)\n",
    "\n",
    "X_train.shape, y_train.shape, X_valid.shape, y_valid.shape, X_test.shape, y_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9a915645",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:16.989459Z",
     "iopub.status.busy": "2025-12-20T08:56:16.988958Z",
     "iopub.status.idle": "2025-12-20T08:56:16.995475Z",
     "shell.execute_reply": "2025-12-20T08:56:16.994444Z"
    },
    "papermill": {
     "duration": 0.014874,
     "end_time": "2025-12-20T08:56:16.997624",
     "exception": false,
     "start_time": "2025-12-20T08:56:16.982750",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_set = TensorDataset(X_train, y_train)\n",
    "valid_set = TensorDataset(X_valid, y_valid)\n",
    "test_set = TensorDataset(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "4b5dd488",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:17.009198Z",
     "iopub.status.busy": "2025-12-20T08:56:17.008797Z",
     "iopub.status.idle": "2025-12-20T08:56:17.014708Z",
     "shell.execute_reply": "2025-12-20T08:56:17.013675Z"
    },
    "papermill": {
     "duration": 0.014283,
     "end_time": "2025-12-20T08:56:17.016828",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.002545",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_loader = DataLoader(train_set, batch_size=100, shuffle=True)\n",
    "valid_loader = DataLoader(valid_set, batch_size=80)\n",
    "test_loader = DataLoader(test_set, batch_size=400)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8a60ffc6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:17.028938Z",
     "iopub.status.busy": "2025-12-20T08:56:17.028587Z",
     "iopub.status.idle": "2025-12-20T08:56:17.075952Z",
     "shell.execute_reply": "2025-12-20T08:56:17.074931Z"
    },
    "papermill": {
     "duration": 0.056437,
     "end_time": "2025-12-20T08:56:17.078079",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.021642",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(torch.Size([100, 21]), torch.Size([100, 1]))"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x_batch, y_batch = next(iter(train_loader))\n",
    "x_batch.shape, y_batch.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "01fc2d0e",
   "metadata": {
    "papermill": {
     "duration": 0.00466,
     "end_time": "2025-12-20T08:56:17.087607",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.082947",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# ü§ñ Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8b14b944",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:17.099687Z",
     "iopub.status.busy": "2025-12-20T08:56:17.098508Z",
     "iopub.status.idle": "2025-12-20T08:56:17.107973Z",
     "shell.execute_reply": "2025-12-20T08:56:17.106826Z"
    },
    "papermill": {
     "duration": 0.017975,
     "end_time": "2025-12-20T08:56:17.110128",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.092153",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Sequential(\n",
       "  (0): Linear(in_features=21, out_features=3, bias=True)\n",
       "  (1): Softmax(dim=1)\n",
       ")"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = nn.Sequential(\n",
    "    nn.Linear(num_features, num_classes),\n",
    "    nn.Softmax(dim=1)\n",
    "    )\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "5924aa18",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:17.122367Z",
     "iopub.status.busy": "2025-12-20T08:56:17.121459Z",
     "iopub.status.idle": "2025-12-20T08:56:17.155298Z",
     "shell.execute_reply": "2025-12-20T08:56:17.154278Z"
    },
    "papermill": {
     "duration": 0.042804,
     "end_time": "2025-12-20T08:56:17.157961",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.115157",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "torch.Size([1530, 3])"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_hat=model(X_train)\n",
    "y_hat.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e0c6baa",
   "metadata": {
    "papermill": {
     "duration": 0.005175,
     "end_time": "2025-12-20T08:56:17.167995",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.162820",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# ‚öôÔ∏è Loss & Optimizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "5e73c7e0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:17.179974Z",
     "iopub.status.busy": "2025-12-20T08:56:17.179594Z",
     "iopub.status.idle": "2025-12-20T08:56:17.186423Z",
     "shell.execute_reply": "2025-12-20T08:56:17.185334Z"
    },
    "papermill": {
     "duration": 0.015597,
     "end_time": "2025-12-20T08:56:17.188577",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.172980",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "CrossEntropyLoss()"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "loss_fn = nn.CrossEntropyLoss()\n",
    "loss_fn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "74421358",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-20T08:56:17.200573Z",
     "iopub.status.busy": "2025-12-20T08:56:17.200154Z",
     "iopub.status.idle": "2025-12-20T08:56:24.342129Z",
     "shell.execute_reply": "2025-12-20T08:56:24.340892Z"
    },
    "papermill": {
     "duration": 7.151067,
     "end_time": "2025-12-20T08:56:24.344655",
     "exception": false,
     "start_time": "2025-12-20T08:56:17.193588",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "SGD (\n",
       "Parameter Group 0\n",
       "    dampening: 0\n",
       "    differentiable: False\n",
       "    foreach: None\n",
       "    fused: None\n",
       "    lr: 0.25\n",
       "    maximize: False\n",
       "    momentum: 0.85\n",
       "    nesterov: False\n",
       "    weight_decay: 0\n",
       ")"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "optimizer=SGD(model.parameters(),lr=0.25,momentum=0.85)\n",
    "optimizer"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 916586,
     "sourceId": 1553068,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31234,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 22.556495,
   "end_time": "2025-12-20T08:56:27.172651",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-12-20T08:56:04.616156",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
